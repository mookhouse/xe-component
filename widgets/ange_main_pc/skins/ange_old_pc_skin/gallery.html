<!--
Copyright inpleworks, Co. 
-->
{@ 
	// gallery size
	if($wi->col_count==4) $col_size = 'col-md-3';
	elseif($wi->col_count==3) $col_size = 'col-md-4';
	elseif($wi->col_count==2) $col_size = 'col-md-6';
	elseif($wi->col_count==6) $col_size = 'col-md-2';
	else $col_size = 'col-md-4';
}
<div id="xet-plus-gallery{$global['xet_plus']}" class="xet-plus-gallery xet-row <!--@if($wi->col_margin=='N')-->mg-xs-0 mg-sm-0<!--@end-->">
	{@ $_idx=0}	
	<block loop="$wi->document_list=>$item">		
		<!--@if($wi->lightbox=="Y")-->
			<!--@if($item->extra_var_name)-->
				<!--// 유투브 추출 -->
				{@ $youtube_url = $item->extra_var_name}					
				<!--@if(preg_match('/http:/', $youtube_url))-->
				{@ $_img = str_replace('http://youtu.be/', 'http://youtube.com/watch?v=', $youtube_url)}
				{@ $video_id = substr($_img, 27)}
				<!--@elseif(preg_match('/https:/', $youtube_url))-->
				{@ $_img = str_replace('https://youtu.be/', 'https://youtube.com/watch?v=', $youtube_url)}
				{@ $video_id = substr($_img, 28)}
				<!--@end-->
			<!--@elseif($item->getUploadedFiles())-->
				{@ $idx=0}
				<block loop="$item->getUploadedFiles()=>$key,$file">
					{@ 
						$_file = $file->source_filename; 
						$_exp = strtolower(substr($_file, strrpos($_file,".")));
					}
					<!--@if(in_array($_exp, array('.gif','.jpg','.jpeg','.png','.bmp')))-->
						<!--@if($idx == 0)-->
						{@ $_img = $file->uploaded_filename; }
						<!--@end-->
					<!--@end-->				
				{@ $idx++}
				</block>		
			<!--@else-->
				{@ $_img = 'widgets/xet_plus_content/skins/xet_default_skin/img/error.png' }
			<!--@end-->
		<!--@end-->
		
		<div class="<!--@if($wi->col_count!='1')-->col-xs-12 col-sm-6 {$col_size}<!--@end--> <!--@if($wi->col_margin=='N')-->mg-xs-t15 pd-xs-0 pd-sm-0<!--@else-->mg-xs-b15 mg-sm-b30<!--@end-->">
			<div class="item equalheight">		
				<div class="thumbnail text-center" cond="$wi->show_thumbnail!='N' && $item->getThumbnail()">				
					<!--@if($wi->lightbox=='Y')-->
					<a href="{$_img}" class="xet-plus-lightbox" title="{strip_tags($item->getTitle())}" rel="lightbox[gallery-{$global['xet_plus']}]">
					<!--@else-->
					<a href="{$item->getPermanentUrl()}" class="" target="_blank"|cond="$wi->new_window">
					<!--@end-->	
					<!--@if($item->extra_var_name)-->	
						{@ $youtube_url = $item->extra_var_name}
						<!--@if($wi->thumbnail_width < 321)-->
						{@ $youtube_thumbnail_size = mqdefault}
						<!--@else-->
						{@ $youtube_thumbnail_size = maxresdefault}
						<!--@end-->
						<!--@if(preg_match('/http:/', $youtube_url))-->
						<img src="{str_replace('http://youtu.be/', 'http://img.youtube.com/vi/', $youtube_url)}/{$youtube_thumbnail_size}.jpg" style="width:100%;" alt="{strip_tags($item->getTitle())}" class="no-opacity"|cond="$wi->show_title=='Y'" />
						<!--@elseif(preg_match('/https:/', $youtube_url))-->
						<img src="{str_replace('https://youtu.be/', 'http://img.youtube.com/vi/', $youtube_url)}/{$youtube_thumbnail_size}.jpg" style="width:100%;" alt="{strip_tags($item->getTitle())}" class="no-opacity"|cond="$wi->show_title=='Y'" />
						<!--@end-->
					<!--@elseif($item->getThumbnail())-->
						<img src="{$item->getThumbnail($wi->thumbnail_width,$wi->thumbnail_height,$wi->thumbnail_type)}" alt="{strip_tags($item->getTitle())}" class="no-opacity"|cond="$wi->show_title=='Y'" />	
					<!--@end-->		
					</a>		
				</div>
				<div class="captions <!--@if($wi->caption_align=='center')-->text-center<!--@end--> <!--@if(!$item->getThumbnail())-->vertical-align<!--@end--> pd-15" cond="$wi->show_title=='Y' || $wi->show_content=='Y' || $wi->show_regdate=='Y' || $wi->show_nickname=='Y' || $wi->show_category_title=='Y' || $wi->show_readed_count=='Y' || $wi->show_comment_count=='Y'">
					<div class="inner middle">
						<h6 class="h6 mg-b10" cond="$wi->show_title!='N'">
							<a href="{$item->getPermanentUrl()}" class="title" target="_blank"|cond="$wi->new_window">{$item->getTitle($wi->subject_cut_size)}</a>
							<span class="xet-plus-content-icon fs-12" cond="$wi->show_icon=='Y'">								
								<i class="xi-new" cond="(int)($item->getRegdate('YmdHis') > date('YmdHis', time()-($wi->duration_new)))"></i>
								<i class="xi-update" cond="((int)($item->get('last_update') > date('YmdHis', time()-($wi->duration_new)))) && ($item->getRegdate('YmdHis') != $item->get('last_update'))"></i>
								<i class="xi-lock" cond="$item->variables[status]=='SECRET'"></i>
							</span>
						</h6>
						<p cond="$wi->show_content=='Y'">{$item->getSummary($wi->content_cut_size)}</p>	
						<p class="fs-12" cond="$wi->show_regdate=='Y' || $wi->show_nickname=='Y' || $wi->show_category_title=='Y' || $wi->show_readed_count=='Y' || $wi->show_comment_count=='Y'">
							<span cond="$wi->show_regdate=='Y'"><i class="fa fa-clock-o" aria-hidden="true"></i> {$item->getRegdate("M d, Y")}</span>
							<span cond="$wi->show_nickname=='Y'"><i class="fa fa-user-circle-o" aria-hidden="true"></i> {cut_str($item->getNickName(), $wi->nickname_cut_size)}</span>
							<span cond="$wi->show_readed_count=='Y' && $item->get('readed_count')"><i class="fa fa-eye" aria-hidden="true"></i> {$item->get('readed_count')}</span>
							<span cond="$wi->show_comment_count=='Y' && $item->getCommentCount()"><i class="fa fa-commenting" aria-hidden="true"></i> {$item->getCommentCount()}</span>
						</p>
						<p class="fs-12" cond="$wi->show_category_title=='Y' && $item->category->title"><i class="fa fa-folder-open" aria-hidden="true"></i> {$item->category->title}</p>
					</div>
				</div>
			</div>
		</div>	
	{@ $_idx++}
	</block>
</div> 

<!--@if($wi->lightbox=='Y')-->
<script>
jQuery(function($){		
	$(document).ready(function(){	
		$('#xet-plus-gallery{$global['xet_plus']} .xet-plus-lightbox').swipebox({
			removeBarsOnMobile : false,
			hideCloseButtonOnMobile : false,
			hideBarsDelay : false,
			autoplayVideos: true,
			afterOpen: function(){
		        var $selectorClose = $("#swipebox-close");
		        var clickAction = "touchend click";		
		        $selectorClose.unbind(clickAction);
		        $selectorClose.bind(clickAction, function(event){
		          	event.preventDefault();
				  	event.stopPropagation();		
				  	$.swipebox.close();
		        });
		    }
		});	
	});			
});
</script>
<!--@end-->